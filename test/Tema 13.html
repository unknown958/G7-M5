<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Test M√≥dulo 5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* { 
    box-sizing: border-box; 
    margin: 0;
    padding: 0;
}

body { 
    font-family: 'Arial', sans-serif; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.container { 
    max-width: 900px; 
    width: 100%;
    margin: auto; 
}

/* Tarjeta principal */
.card { 
    background: white;
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

/* Decoraci√≥n de la tarjeta */
.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1);
}

/* T√≠tulos */
h1, h2, h3 {
    text-align: center;
    margin-bottom: 25px;
}

h1 {
    color: #2d3436;
    font-size: 2.5rem;
    background: linear-gradient(90deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    font-weight: bold;
    margin-bottom: 20px;
}

h2 {
    color: #2d3436;
    font-size: 2rem;
    margin-bottom: 30px;
}

/* Informaci√≥n de progreso */
.info {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
    font-weight: bold;
    background: #f8f9fa;
    padding: 15px;
    border-radius: 12px;
    border: 2px solid #e9ecef;
}

#progress {
    color: #495057;
    font-size: 1.1rem;
}

#timer {
    color: #667eea;
    font-size: 1.1rem;
    font-weight: bold;
}

/* Pregunta */
.question {
    font-size: 1.3rem;
    margin-bottom: 30px;
    font-weight: bold;
    color: #2d3436;
    line-height: 1.5;
    padding: 0 10px;
}

/* Opciones */
.options {
    margin-bottom: 30px;
}

.options label {
    display: block;
    padding: 20px 25px;
    margin-bottom: 15px;
    border-radius: 15px;
    border: 3px solid #e9ecef;
    cursor: pointer;
    transition: all 0.3s ease;
    background: #f8f9fa;
    color: #495057;
    font-size: 1.1rem;
    line-height: 1.4;
    position: relative;
}

.options label:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
    border-color: #667eea;
    background: white;
}

.options label.selected {
    background: #e8f4ff;
    border-color: #667eea;
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
}

.options label.option-wrong {
    border-color: #ff6b6b;
    background: #fff5f5;
}

.options label.option-correct {
    border-color: #4ecdc4;
    background: #f0fffd;
}

/* Botones */
button {
    padding: 18px 30px;
    font-size: 1.1rem;
    border-radius: 12px;
    border: none;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
    width: 100%;
    margin-top: 10px;
}

button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
}

button.secondary {
    background: linear-gradient(135deg, #4ecdc4, #45b7d1);
}

#prevBtn, #nextBtn {
    width: 48%;
    padding: 18px;
}

.button-container {
    display: flex;
    gap: 4%;
    margin-top: 20px;
    justify-content: flex-end;
}

/* Pantalla final */
.final { 
    display: none; 
    text-align: center;
}

.final h2 {
    font-size: 2.5rem;
    margin-bottom: 30px;
}

#summary, #finalTime, #finalNote {
    font-size: 1.2rem;
    margin-bottom: 20px;
    color: #495057;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 12px;
}

#finalNote {
    font-size: 1.5rem;
    font-weight: bold;
    color: #667eea;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    padding: 20px;
    border-left: 5px solid #667eea;
}

/* Preguntas incorrectas */
.failed-question {
    margin-top: 30px;
    padding-top: 25px;
    border-top: 2px solid #e9ecef;
}

.failed-question .question-text {
    margin-bottom: 20px;
    font-weight: bold;
    color: #2d3436;
    font-size: 1.2rem;
}

/* ===== Di√°logo de test guardado ===== */
#resumeDialog {
    display: none; 
    position: fixed; 
    top: 0; 
    left: 0; 
    right: 0; 
    bottom: 0; 
    background: rgba(0,0,0,0.8); 
    z-index: 9999;
    justify-content: center; 
    align-items: center;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

#resumeDialog .card {
    max-width: 500px; 
    background: white;        
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    display: flex; 
    flex-direction: column;
    align-items: center;
    gap: 20px;
    text-align: center;
    animation: slideUp 0.4s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

#resumeDialog h2 { 
    margin: 0; 
    font-size: 2rem;
    color: #2d3436;
}

#resumeDialog p { 
    margin: 0; 
    font-size: 1.2rem;
    color: #636e72;
    line-height: 1.6;
}

#resumeDialog button { 
    width: 80%; 
    padding: 18px; 
    font-size: 1.1rem; 
    border-radius: 12px; 
    border: none; 
    cursor: pointer; 
    transition: all 0.3s ease;
    font-weight: bold;
}

#resumeDialog button#continueBtn { 
    background: linear-gradient(135deg, #4ecdc4, #45b7d1);
    color: white; 
}

#resumeDialog button#continueBtn:hover { 
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
}

#resumeDialog button#newBtn { 
    background: linear-gradient(135deg, #ff6b6b, #ee5a52);
    color: white; 
}

#resumeDialog button#newBtn:hover { 
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
}

#resumeDialog button + button { 
    margin-top: 10px; 
}

/* Responsive */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    .card {
        padding: 25px;
    }
    
    h1 {
        font-size: 2rem;
    }
    
    h2 {
        font-size: 1.8rem;
    }
    
    .question {
        font-size: 1.1rem;
    }
    
    .options label {
        padding: 15px 20px;
        font-size: 1rem;
    }
    
    button {
        padding: 16px 20px;
        font-size: 1rem;
    }
    
    #prevBtn, #nextBtn {
        width: 48%;
        padding: 16px;
    }
}
</style>
</head>
<body>
<div class="container">

    <!-- Di√°logo para continuar test guardado -->
    <div id="resumeDialog">
        <div class="card">
            <h2>üíæ Test guardado</h2>
            <p>Se detect√≥ un test previo guardado. ¬øDeseas continuar o empezar uno nuevo?</p>
            <button id="continueBtn">Continuar</button>
            <button id="newBtn">Empezar de nuevo</button>
        </div>
    </div>

    <!-- Pantalla de cuestionario -->
    <div class="card" id="quizCard">
        <h1 id="themeTitle"></h1>
        <div class="info">
            <div id="progress"></div>
            <div id="timer">‚è± 00:00</div>
        </div>
        <div class="question" id="questionText"></div>
        <div class="options" id="options"></div>
        <div class="button-container">
            <button id="prevBtn">Anterior</button>
            <button id="nextBtn">Siguiente</button>
        </div>
    </div>

    <!-- Pantalla final -->
    <div class="card final" id="finalScreen">
        <h2>üìä Resultado final</h2>
        <p id="summary"></p>
        <p id="finalTime"></p>
        <p id="finalNote"></p>
        <div id="failedContainer" style="display:none;"></div>
        <button class="secondary" id="restartBtn">Repetir test</button>
    </div>

</div>

<script>
// === Preguntas ===
const themes = [
{
  "name": "Bomberos",
  "questions": [
  {
    "question": "Indica la respuesta correcta en cuanto al BLEVE.",
    "options": [
      "Se trata de una explosi√≥n de vapores que se expanden al hervir el l√≠quido.",
      "Grandes explosiones con bola de fuego.",
      "En caso de producirse en cisternas, la metralla puede llegar hasta 1 km de distancia.",
      "Todas son correctas. "
    ],
    "answer": "Todas son correctas. "
  },
  {
    "question": "¬øCu√°l de los siguientes productos presenta el mayor √≠ndice de inflamabilidad, es decir, es altamente explosivo?",
    "options": [
      "Hidr√≥geno. ",
      "Mon√≥xido de propano.",
      "Metano.",
      "Mon√≥xido de carbono."
    ],
    "answer": "Hidr√≥geno. "
  },
  {
    "question": "¬øEn cu√°l de las fases del desarrollo de un incendio ventilado aumenta m√°s la temperatura?",
    "options": [
      "Fase de fuego inicial.",
      "Fase de fuego en desarrollo. ",
      "Fase de fuego totalmente desarrollado.",
      "Flashover. (El fuego respira completamente)"
    ],
    "answer": "Fase de fuego en desarrollo. "
  },
  {
    "question": "Como norma general la evacuaci√≥n ser√° aconsejable‚Ä¶",
    "options": [
      "En locales de p√∫blica concurrencia. ",
      "En viviendas bifamiliares.",
      "En edificios de madera, sin riesgo de propagaci√≥n del incendio por todo eledificio.",
      "En incendio propagado a otros pisos o con posible riesgo de propagaci√≥n."
    ],
    "answer": "En locales de p√∫blica concurrencia. "
  },
  {
    "question": "El orden de evacuaci√≥n ser√° el siguiente.",
    "options": [
      "Primero la planta afectada, segundo la inmediata inferior con caja de escaleras libre de humo, tercero la planta superior, cuarto resto de plantas.",
      "Primero la planta afectada, segundo la inmediata superior con caja de escaleras libre de humo, tercero la planta inferior, cuarto resto de plantas. ",
      "Primero planta superior, segundo la planta afectada con caja de escaleras libre de humo. Generalmente as√≠ ser√° suficiente.",
      "Primero la planta superior, segundo la planta afectada con caja de escaleras libre de humo, tercero la planta inferior, cuarto resto de plantas."
    ],
    "answer": "Primero la planta afectada, segundo la inmediata superior con caja de escaleras libre de humo, tercero la planta inferior, cuarto resto de plantas. "
  },
  {
    "question": "El gas envasado/embotellado, que principalmente es el butano, tiene un peso....",
    "options": [
      "Mayor que el aire, por tanto se eleva sobre el aire.",
      "Mayor que el aire, por tanto se concentra debajo del aire. ",
      "Menor que el aire, por tanto se eleva sobre el aire.",
      "Menor que el aire, por tanto de concentra debajo del aire."
    ],
    "answer": "Mayor que el aire, por tanto se concentra debajo del aire. "
  },
  {
    "question": "¬øQu√© es una atm√≥sfera explosiva?",
    "options": [
      "La mezcla con el aire, en condiciones atmosf√©ricas normales, de sustancias inflamables en forma de gases, vapores, nieblas o polvos, en la que tras una ignici√≥n, la combusti√≥n se propaga a la totalidad de la mezcla no quemada. ",
      "La mezcla en condiciones atmosf√©ricas normales, de sustancias inflamables en forma de gases, vapores, nieblas o polvos, en la que tras una ignici√≥n, la combusti√≥n se propaga a la totalidad de la mezcla no quemada.",
      "La mezcla con el aire, en condiciones atmosf√©ricas normales, de sustancias inflamables en forma de polvos, en la que tras una ignici√≥n, la combusti√≥n se propaga a la totalidad de la mezcla no quemada.",
      "La mezcla en condiciones atmosf√©ricas normales, de sustancias inflamables en forma de polvos, en la que tras una ignici√≥n, la combusti√≥n se propaga a la totalidad de la mezcla no quemada."
    ],
    "answer": "La mezcla con el aire, en condiciones atmosf√©ricas normales, de sustancias inflamables en forma de gases, vapores, nieblas o polvos, en la que tras una ignici√≥n, la combusti√≥n se propaga a la totalidad de la mezcla no quemada. "
  },
  {
    "question": "La gasolina... (Se√±ale la incorrectA.",
    "options": [
      "Tiene un punto de inflamaci√≥n de -38 grados, a partir de esa temperatura comienza a evaporarse. A temperatura ambiente se evapora r√°pidamente.",
      "Mezclada con aire forma atm√≥sfera explosiva.",
      "Los vapores son m√°s pesados que el aire, por lo que inundan zonas bajas aunque el l√≠quido no haya llegado.",
      "Usar como acelerante solamente gasolina, no mezclar con gas√≥leo, resulta m√°s seguro. "
    ],
    "answer": "Usar como acelerante solamente gasolina, no mezclar con gas√≥leo, resulta m√°s seguro. "
  },
  {
    "question": "El √Åcido Cianh√≠drico o Cianuro de Hidr√≥geno...",
    "options": [
      "Mata a un humano en cuesti√≥n de minutos con una concentraci√≥n de 300 partes por mill√≥n en aire.",
      "Su toxicidad se debe al ion Cianuro CN, que inhibe la respiraci√≥n celular.",
      "Suele producirse por la combusti√≥n de productos sint√©ticos como aluminio, m√°rmol, hongos, etc",
      "A y B son correctas. "
    ],
    "answer": "A y B son correctas. "
  },
  {
    "question": "La zona TEMPLADA en emergencias de bomberos se encontrar√°...",
    "options": [
      "Personal y veh√≠culos de bomberos.",
      "Delimitada por mandos Bomberos",
      "Controlada por la polic√≠a.",
      "Todas son correctas. "
    ],
    "answer": "Todas son correctas. "
  },
  {
    "question": "Ante un incidente qu√≠mico, los l√≠mites de la zona CALIENTE ...",
    "options": [
      "Ser√°n marcados y controlados por personal de polic√≠a, delimitando un m√≠nimo de 50 metros en dicho incidente.",
      "Ser√°n marcados y controlados por personal de bomberos, delimitando un m√≠nimo de 50 metros en dicho incidente. ",
      "Ser√°n marcados y controlados por personal de polic√≠a, delimitando un m√≠nimo de 100 metros en dicho incidente.",
      "Ser√°n marcados y controlados por personal de bomberos, delimitando un m√≠nimo de 100 metros en dicho incidente."
    ],
    "answer": "Ser√°n marcados y controlados por personal de bomberos, delimitando un m√≠nimo de 50 metros en dicho incidente. "
  },
  {
    "question": "¬øQu√© fen√≥meno puede darse en un incendio que se ha desarrollado en condiciones de ventilaci√≥n restringida (NO ventilado)?",
    "options": [
      "Flashover, deflagraci√≥n que ocurre cuando aire rico en ox√≠geno entra en contacto con un incendio en un entorno con bajos niveles de ox√≠geno, permitiendo la r√°pida expansi√≥n de la llama.",
      "Backdraft, deflagraci√≥n que ocurre cuando aire rico en ox√≠geno entra en contacto con un incendio en un entorno con bajos niveles de ox√≠geno, permitiendo la r√°pida expansi√≥n de la llama. ",
      "Flashover, o combusti√≥n s√∫bita generalizada. Todas las superficies combustibles que hasta ese momento no estaban implicadas en el incendio, comienzan a arder por la radiaci√≥n de la combusti√≥n de las capas de gases.",
      "Backdraft. Todas las superficies combustibles que hasta ese momento no estaban implicadas en el incendio, comienzan a arder por la radiaci√≥n de la combusti√≥n de las capas de gases."
    ],
    "answer": "Backdraft, deflagraci√≥n que ocurre cuando aire rico en ox√≠geno entra en contacto con un incendio en un entorno con bajos niveles de ox√≠geno, permitiendo la r√°pida expansi√≥n de la llama. "
  },
  {
    "question": "El l√≠mite superior de inflamabilidad (LSI) es ...",
    "options": [
      "La concentraci√≥n m√≠nima de gas en el aire por debajo de la cual el fuego no es posible.",
      "La concentraci√≥n m√°xima de gas en el aire por encima de la cual el fuego es posible.",
      "Todas son correctas.",
      "Ninguna es correcta. "
    ],
    "answer": "Ninguna es correcta. "
  },
  {
    "question": "Si un bombero echa agua en un contenedor de resto de poda sobre que act√∫a?",
    "options": [
      "Comburente.",
      "Calor.",
      "Combustible. ",
      "Todas son correctas."
    ],
    "answer": "Combustible. "
  },
  {
    "question": "¬øQu√© peligros tiene el acetileno?",
    "options": [
      "Puede reaccionar por calor, golpe o fricci√≥n.",
      "Es muy inestable, con alto riesgo de explosi√≥n.",
      "Forma una amplia gradaci√≥n de mezclas explosivas en el aire.",
      "Todas son correctas. "
    ],
    "answer": "Todas son correctas. "
  },
  {
    "question": "¬øQu√© lleva el extintor de CO2?",
    "options": [
      "Gas CO2 a presi√≥n.(nieve carb√≥nicA. ",
      "Agua.",
      "Polvo.",
      "Gas CO2 y agua."
    ],
    "answer": "Gas CO2 a presi√≥n.(nieve carb√≥nicA. "
  },
  {
    "question": "¬øQu√© peligros tiene la gasolina?",
    "options": [
      "Emite gases que pueden ser inflamables a temperatura ambiente. (Se evapora r√°pidamente) ",
      "Los gases inundan las zonas altas.",
      "En caso de derrame no se formar√° una atm√≥sfera explosiva.",
      "Todas incorrectas."
    ],
    "answer": "Emite gases que pueden ser inflamables a temperatura ambiente. (Se evapora r√°pidamente) "
  },
  {
    "question": "En caso de darse un incendio en un baserri, lo m√°s recomendable ser√≠a‚Ä¶",
    "options": [
      "Evacuar. ",
      "Confinar.",
      "Depender√° del lugar donde se aloje el fuego.",
      "Evacuar si la escalera se encuentra libre de humo."
    ],
    "answer": "Evacuar. "
  },
  {
    "question": "En caso de darse un incendio en un centro comercial, lo m√°s recomendable ser√≠a‚Ä¶",
    "options": [
      "Evacuar. ",
      "Confinar.",
      "Depender√° del lugar donde se aloje el fuego.",
      "Evacuar si la escalera se encuentra libre de humo."
    ],
    "answer": "Evacuar. "
  }
]
},
]

// === Variables ===
let theme = themes[0];
let index=0, correct=0, incorrect=0, startTime=Date.now(), answers=[], timerInterval;

// === DOM ===
const themeTitle = document.getElementById("themeTitle");
const questionText = document.getElementById("questionText");
const optionsDiv = document.getElementById("options");
const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");
const progress = document.getElementById("progress");
const timer = document.getElementById("timer");

const quizCard = document.getElementById("quizCard");
const finalScreen = document.getElementById("finalScreen");
const summary = document.getElementById("summary");
const finalTime = document.getElementById("finalTime");
const finalNote = document.getElementById("finalNote");
const failedContainer = document.getElementById("failedContainer");

const resumeDialog = document.getElementById("resumeDialog");
const continueBtn = document.getElementById("continueBtn");
const newBtn = document.getElementById("newBtn");
const restartBtn = document.getElementById("restartBtn");

// === Funciones ===
function initTest(loadSaved=false){
    const saved = localStorage.getItem("testState");
    if(!loadSaved && saved){
        resumeDialog.style.display="flex";
        quizCard.style.display="none";
        finalScreen.style.display="none";
        return;
    }

    resumeDialog.style.display="none";
    quizCard.style.display="block";
    finalScreen.style.display="none";

    if(loadSaved && saved){
        const state = JSON.parse(saved);
        index=state.index; correct=state.correct; incorrect=state.incorrect;
        startTime=state.startTime; answers=state.answers;
    }else{
        index=0; correct=0; incorrect=0; startTime=Date.now(); answers=[];
        localStorage.removeItem("testState");
    }

    themeTitle.textContent = theme.name;
    clearInterval(timerInterval);
    timerInterval=setInterval(updateTimer,1000);
    loadQuestion();
}

function loadQuestion(){
    const q = theme.questions[index];
    questionText.textContent=q.question;
    optionsDiv.innerHTML="";
    progress.textContent=`Pregunta ${index+1} / ${theme.questions.length}`;

    q.options.forEach(opt=>{
        const label=document.createElement("label");
        label.textContent=opt;
        if(answers[index]?.selected===opt) label.classList.add("selected");
        label.addEventListener("click",()=>{
            document.querySelectorAll(".options label").forEach(l=>l.classList.remove("selected"));
            label.classList.add("selected");
            answers[index]={question:q.question, options:q.options, correct:q.answer, selected:opt, number:index+1};
            saveProgress();
        });
        optionsDiv.appendChild(label);
    });

    prevBtn.style.display = index===0 ? "none" : "inline-block";
    nextBtn.textContent = index===theme.questions.length-1 ? "Finalizar" : "Siguiente";
}

function saveProgress(){
    localStorage.setItem("testState", JSON.stringify({index, correct, incorrect, startTime, answers}));
}

nextBtn.addEventListener("click", ()=>{
    const selectedAnswer = answers[index]?.selected || null; // null si no respondi√≥
    const q = theme.questions[index];

    answers[index] = { question:q.question, options:q.options, correct:q.answer, selected:selectedAnswer, number:index+1 };
    saveProgress();

    if(selectedAnswer){
        if(selectedAnswer === q.answer) correct++;
        else incorrect++;
    }

    if(index < theme.questions.length-1){ index++; loadQuestion();}
    else finishTest();
});

prevBtn.addEventListener("click", ()=>{
    if(index>0) index--; loadQuestion();
});

function finishTest(){
    clearInterval(timerInterval);
    localStorage.removeItem("testState");
    quizCard.style.display="none";
    finalScreen.style.display="block";

    const totalSeconds = Math.floor((Date.now()-startTime)/1000);
    const min = String(Math.floor(totalSeconds/60)).padStart(2,"0");
    const sec = String(totalSeconds %60).padStart(2,"0");
    const rawScore = correct - (incorrect/3);
    const note = Math.max(0,(rawScore/theme.questions.length)*10).toFixed(2);

    summary.innerHTML=`‚úîÔ∏è Correctas: <strong>${correct}</strong><br>‚ùå Incorrectas: <strong>${incorrect}</strong>`;
    finalTime.textContent=`‚è± Tiempo total: ${min}:${sec}`;
    finalNote.innerHTML=`üéØ Nota final: <strong style="font-size: 2rem; color: #667eea;">${note}/10</strong>`;

    failedContainer.style.display="block";
    failedContainer.innerHTML = "";

    // Preguntas incorrectas
    const failed = answers.filter(a=>a.selected && a.selected!==a.correct);
    if(failed.length){
        const failedDiv = document.createElement("div");
        failedDiv.innerHTML = "<h3 style='color: #ff6b6b; margin-bottom: 20px;'>üìù Preguntas incorrectas</h3>";
        failed.forEach(a=>{
            const div=document.createElement("div"); div.className="failed-question";
            div.innerHTML=`<div class="question-text">Pregunta ${a.number}: ${a.question}</div>`;
            const opts=document.createElement("div"); opts.className="options";
            a.options.forEach(opt=>{
                const label=document.createElement("label");
                if(opt===a.correct) label.classList.add("option-correct");
                if(opt===a.selected) label.classList.add("option-wrong");
                label.textContent=opt;
                opts.appendChild(label);
            });
            div.appendChild(opts);
            failedDiv.appendChild(div);
        });
        failedContainer.appendChild(failedDiv);
    }

    // Preguntas no respondidas
    const unanswered = answers.filter(a=>a.selected===null);
    if(unanswered.length){
        const unDiv = document.createElement("div");
        unDiv.innerHTML="<h3 style='color: #636e72; margin-bottom: 20px;'>‚ùì Preguntas no respondidas</h3>";
        unanswered.forEach(a=>{
            const div=document.createElement("div"); div.className="failed-question";
            div.innerHTML=`<div class="question-text">Pregunta ${a.number}: ${a.question}</div>`;
            const opts=document.createElement("div"); opts.className="options";
            a.options.forEach(opt=>{
                const label=document.createElement("label");
                if(opt===a.correct) label.classList.add("option-correct");
                label.textContent=opt;
                opts.appendChild(label);
            });
            div.appendChild(opts);
            unDiv.appendChild(div);
        });
        failedContainer.appendChild(unDiv);
    }
}

function updateTimer(){
    const elapsed = Math.floor((Date.now()-startTime)/1000);
    const m = String(Math.floor(elapsed/60)).padStart(2,"0");
    const s = String(elapsed%60).padStart(2,"0");
    timer.textContent=`‚è± ${m}:${s}`;
}

function restartTest(){
    correct=0; incorrect=0; index=0; answers=[]; startTime=Date.now();
    localStorage.removeItem("testState");
    initTest(false);
}

// === Botones ===
continueBtn.addEventListener("click", ()=>initTest(true));
newBtn.addEventListener("click", ()=>restartTest());
restartBtn.addEventListener("click", ()=>restartTest());

// A√±adir bot√≥n de volver al inicio
const backButton = document.createElement("button");
backButton.textContent = "Volver al inicio";
backButton.style.background = "linear-gradient(135deg, #ff6b6b, #ee5a52)";
backButton.style.marginTop = "20px";
backButton.addEventListener("click", () => {
    window.location.href = "../index.html";
});
document.getElementById("finalScreen").appendChild(backButton);

initTest();
</script>
</body>
</html>